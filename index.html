<!DOCTYPE html>
<html lang="id">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>Login + Update GitHub DB</title>
Â  <style>
Â  Â  body {
Â  Â  Â  background: #111;
Â  Â  Â  color: #fff;
Â  Â  Â  font-family: sans-serif;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;
Â  Â  Â  height: 100vh;
Â  Â  Â  flex-direction: column;
Â  Â  }
Â  Â  form {
Â  Â  Â  background: #222;
Â  Â  Â  padding: 20px;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  box-shadow: 0 0 10px #000;
Â  Â  Â  width: 300px;
Â  Â  }
Â  Â  input, button {
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 10px;
Â  Â  Â  margin: 10px 0;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 5px;
Â  Â  }
Â  Â  button {
Â  Â  Â  background-color: #4CAF50;
Â  Â  Â  color: white;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  #status { margin-top: 10px; font-size: 0.9em; }
Â  </style>
</head>
<body>

<form id="loginForm">
Â  <h2>Login</h2>
Â  <input type="text" id="username" placeholder="Username" required />
Â  <input type="password" id="password" placeholder="Password" required />
Â  <input type="text" id="nomor" placeholder="Nomor (62xxxx)" required />
Â  <button type="submit">Login & Simpan Nomor</button>
Â  <div id="status"></div>
</form>

<script>
const akunURL = 'https://raw.githubusercontent.com/HanzyyOffc/akun/main/akun.json'; // <- Ganti sesuai akun
const databaseFilePath = 'database.json';
const repoOwner = 'USERNAME'; // GitHub username
const repoName = 'REPO'; Â  Â  Â // Nama repo
const branch = 'main'; Â  Â  Â  Â // Branch
const token = 'ghp_xxx...'; Â  // <- Masukkan GitHub Token kamu disini

const apiBase = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${databaseFilePath}`;

async function fetchRawJSON(url) {
Â  const res = await fetch(url);
Â  if (!res.ok) throw new Error('Gagal ambil data');
Â  return await res.json();
}

async function getDatabaseFile() {
Â  const res = await fetch(apiBase, {
Â  Â  headers: { Authorization: `token ${token}` }
Â  });
Â  if (!res.ok) throw new Error('Gagal fetch konten');
Â  return await res.json();
}

async function updateDatabase(newNomor) {
Â  const file = await getDatabaseFile();
Â  const currentData = JSON.parse(atob(file.content));

Â  if (currentData.includes(newNomor)) {
Â  Â  return { status: 'exists' };
Â  }

Â  currentData.push(newNomor);
Â  const updatedContent = btoa(JSON.stringify(currentData, null, 2));

Â  const updateRes = await fetch(apiBase, {
Â  Â  method: 'PUT',
Â  Â  headers: {
Â  Â  Â  Authorization: `token ${token}`,
Â  Â  Â  'Content-Type': 'application/json'
Â  Â  },
Â  Â  body: JSON.stringify({
Â  Â  Â  message: `Tambah nomor ${newNomor}`,
Â  Â  Â  content: updatedContent,
Â  Â  Â  sha: file.sha,
Â  Â  Â  branch
Â  Â  })
Â  });

Â  if (!updateRes.ok) throw new Error('Gagal update GitHub');
Â  return { status: 'success' };
}

document.getElementById('loginForm').addEventListener('submit', async function (e) {
Â  e.preventDefault();
Â  const uname = username.value.trim();
Â  const pass = password.value.trim();
Â  const nomor = nomorInput.value.trim();
Â  const statusBox = document.getElementById('status');

Â  statusBox.innerText = "ðŸ”„ Memeriksa login...";

Â  try {
Â  Â  const akun = await fetchRawJSON(akunURL);
Â  Â  if (akun.username !== uname || akun.password !== pass) {
Â  Â  Â  statusBox.innerText = 'âŒ Login gagal. Username/Password salah!';
Â  Â  Â  return;
Â  Â  }

Â  Â  statusBox.innerText = 'âœ… Login berhasil! Menyimpan nomor...';

Â  Â  const result = await updateDatabase(nomor);
Â  Â  if (result.status === 'success') {
Â  Â  Â  statusBox.innerText = 'âœ… Nomor berhasil ditambahkan ke database!';
Â  Â  } else if (result.status === 'exists') {
Â  Â  Â  statusBox.innerText = 'â„¹ï¸ Nomor sudah ada di database.';
Â  Â  }
Â  } catch (err) {
Â  Â  statusBox.innerText = 'âŒ Terjadi kesalahan: ' + err.message;
Â  }
});
</script>

</body>
</html>
